{"id":585,"fid":585,"name":"Investments in 2016","slug":"investments-in-2016","link":"https://leetcode.com/problems/investments-in-2016/description/","percent":44.43857331571995,"level":"Medium","category":"database","totalAC":"5K","totalSubmit":"11.4K","desc":"Write a query to print the sum of all total investment values in 2016 (TIV_2016), to a scale of 2 decimal places, for all policy holders who meet the following criteria:\r\n\r\n\r\nHave the same TIV_2015 value as one or more other policyholders.\r\nAre not located in the same city as any other policyholder (i.e.: the (latitude, longitude) attribute pairs must be unique).\r\n\r\n\r\nInput Format:\r\nThe insurance table is described as follows:\r\n\r\n\r\n| Column Name | Type          |\r\n|-------------|---------------|\r\n| PID         | INTEGER(11)   |\r\n| TIV_2015    | NUMERIC(15,2) |\r\n| TIV_2016    | NUMERIC(15,2) |\r\n| LAT         | NUMERIC(5,2)  |\r\n| LON         | NUMERIC(5,2)  |\r\n\r\n\r\nwhere PID is the policyholder's policy ID, TIV_2015 is the total investment value in 2015, TIV_2016 is the total investment value in 2016, LAT is the latitude of the policy holder's city, and LON is the longitude of the policy holder's city.\r\n\r\nSample Input\r\n\r\n\r\n| PID | TIV_2015 | TIV_2016 | LAT | LON |\r\n|-----|----------|----------|-----|-----|\r\n| 1   | 10       | 5        | 10  | 10  |\r\n| 2   | 20       | 20       | 20  | 20  |\r\n| 3   | 10       | 30       | 20  | 20  |\r\n| 4   | 10       | 40       | 40  | 40  |\r\n\r\n\r\nSample Output\r\n\r\n| TIV_2016 |\r\n|----------|\r\n| 45.00    |\r\n\r\n\r\nExplanation\r\n\r\n\r\nThe first record in the table, like the last record, meets both of the two criteria.\r\nThe TIV_2015 value '10' is as the same as the third and forth record, and its location unique.\r\n\r\nThe second record does not meet any of the two criteria. Its TIV_2015 is not like any other policyholders.\r\n\r\nAnd its location is the same with the third record, which makes the third record fail, too.\r\n\r\nSo, the result is the sum of TIV_2016 of the first and last record, which is 45.","templates":[{"value":"mysql","text":"MySQL","defaultCode":"# Write your MySQL query statement below\r\n"}],"testcase":"{\"headers\":{\"insurance\":[\"PID\",\"TIV_2015\",\"TIV_2016\",\"LAT\",\"LON\"]},\"rows\":{\"insurance\":[[1,10,5,10,10],[2,20,20,20,20],[3,10,30,20,20],[4,10,40,40,40]]}}","testable":true,"templateMeta":{"mysql":["CREATE TABLE IF NOT EXISTS insurance (PID INTEGER(11), TIV_2015 NUMERIC(15,2), TIV_2016 NUMERIC(15,2), LAT NUMERIC(5,2), LON NUMERIC(5,2) )"],"database":true}}